<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>강한 매니저 - AI 기반 교육 운영 관리 대시보드</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <img src="https://www.genspark.ai/api/files/s/1lqMcLhw" alt="강한 매니저 로고" class="header-logo">
                <div class="header-title">
                    <h1 data-i18n="header.title">강한 매니저</h1>
                    <span class="subtitle" data-i18n="header.subtitle">AI 기반 교육 관리 시스템</span>
                </div>
            </div>
            <div class="header-right">
                <button id="themeToggle" class="theme-toggle-btn" title="테마 전환">
                    <i class="fas fa-adjust"></i>
                    <span id="themeLabel">라이트 모드</span>
                </button>
                <div class="language-selector-container">
                    <button id="languageToggle" class="language-toggle-btn" title="언어 변경">
                        <i class="fas fa-globe"></i>
                        <span id="currentLanguage">한국어</span>
                    </button>
                    <div id="languageDropdown" class="language-dropdown">
                        <button class="language-option" data-lang="ko">
                            <span class="flag-icon">🇰🇷</span>
                            <span>한국어</span>
                        </button>
                        <button class="language-option" data-lang="en">
                            <span class="flag-icon">🇺🇸</span>
                            <span>English</span>
                        </button>
                        <button class="language-option" data-lang="ja">
                            <span class="flag-icon">🇯🇵</span>
                            <span>日本語</span>
                        </button>
                        <button class="language-option" data-lang="zh">
                            <span class="flag-icon">🇨🇳</span>
                            <span>中文</span>
                        </button>
                        <button class="language-option" data-lang="ar">
                            <span class="flag-icon">🇸🇦</span>
                            <span>العربية</span>
                        </button>
                    </div>
                </div>
                <div class="status-badge" id="systemStatusBadge">
                    <i class="fas fa-circle" id="systemStatusIcon"></i> <span id="systemStatusText"
                        data-i18n="system.standby">시스템 대기중</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- Control Panel -->
            <section class="control-panel">
                <h2><i class="fas fa-sliders-h"></i> <span data-i18n="control.title">제어 패널</span></h2>
                <div style="margin-bottom: 15px;">
                    <label for="conferenceUrl" style="display: block; margin-bottom: 5px; font-weight: bold;">
                        <i class="fas fa-link"></i> <span data-i18n="control.conferenceUrl">감독할 회의 URL</span>
                    </label>
                    <input type="text" id="conferenceUrl" class="manage-input"
                        placeholder="https://teams.microsoft.com/..."
                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
                </div>

                <div class="control-buttons">
                    <button id="startMonitoring" class="control-btn start-btn">
                        <i class="fas fa-play"></i>
                        <span data-i18n="control.start">감독 시작</span>
                    </button>
                    <button id="stopMonitoring" class="control-btn stop-btn" disabled>
                        <i class="fas fa-stop"></i>
                        <span data-i18n="control.stop">감독 종료</span>
                    </button>
                    <button id="pauseMonitoring" class="control-btn pause-btn" disabled>
                        <i class="fas fa-pause"></i>
                        <span data-i18n="control.pause">일시 정지</span>
                    </button>
                    <button id="emergencyAlert" class="control-btn alert-btn">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span data-i18n="control.emergency">긴급 공지</span>
                    </button>
                </div>
            </section>

            <!-- Statistics Cards -->
            <section class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon total">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <h3 data-i18n="stats.total">총 수강생</h3>
                        <p class="stat-value" id="totalStudents">8</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon present">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-content">
                        <h3 data-i18n="stats.present">출석</h3>
                        <p class="stat-value" id="presentStudents">7</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon absent">
                        <i class="fas fa-user-times"></i>
                    </div>
                    <div class="stat-content">
                        <h3 data-i18n="stats.absent">결석</h3>
                        <p class="stat-value" id="absentStudents">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon warning">
                        <i class="fas fa-exclamation-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 data-i18n="stats.warning">경고</h3>
                        <p class="stat-value" id="warningStudents">1</p>
                    </div>
                </div>
            </section>

            <!-- Agent Status -->
            <section class="agent-status-section">
                <h2><i class="fas fa-robot"></i> <span data-i18n="agent.title">AI 에이전트 상태</span></h2>
                <div class="agent-grid">
                    <div class="agent-card" data-agent="admin">
                        <div class="agent-header">
                            <i class="fas fa-user-cog"></i>
                            <h3 data-i18n="agent.admin">운영 Agent</h3>
                            <button class="agent-settings-btn" onclick="openAgentSettings('admin')" title="설정">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                        <div class="agent-status active">
                            <i class="fas fa-circle"></i> <span data-i18n="agent.status.active">활성</span>
                        </div>
                        <p class="agent-description" data-i18n="agent.desc.admin">교육 Q&A, 공지사항, 일정 관리</p>
                    </div>
                    <div class="agent-card" data-agent="tutor">
                        <div class="agent-header">
                            <i class="fas fa-graduation-cap"></i>
                            <h3 data-i18n="agent.tutor">학습 Agent</h3>
                            <button class="agent-settings-btn" onclick="openAgentSettings('tutor')" title="설정">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                        <div class="agent-status active">
                            <i class="fas fa-circle"></i> <span data-i18n="agent.status.active">활성</span>
                        </div>
                        <p class="agent-description" data-i18n="agent.desc.tutor">수업 질의응답, 내용 요약</p>
                    </div>
                    <div class="agent-card" data-agent="monitor">
                        <div class="agent-header">
                            <i class="fas fa-video"></i>
                            <h3 data-i18n="agent.monitor">감시 Agent</h3>
                            <button class="agent-settings-btn" onclick="openAgentSettings('monitor')" title="설정">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                        <div class="agent-status inactive">
                            <i class="fas fa-circle"></i> <span data-i18n="agent.status.inactive">비활성</span>
                        </div>
                        <p class="agent-description" data-i18n="agent.desc.monitor">카메라 화면 감시, 경고 발송</p>
                    </div>
                    <div class="agent-card" data-agent="attendance">
                        <div class="agent-header">
                            <i class="fas fa-clipboard-check"></i>
                            <h3 data-i18n="agent.attendance">출결 Agent</h3>
                            <button class="agent-settings-btn" onclick="openAgentSettings('attendance')" title="설정">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                        <div class="agent-status active">
                            <i class="fas fa-circle"></i> <span data-i18n="agent.status.active">활성</span>
                        </div>
                        <p class="agent-description" data-i18n="agent.desc.attendance">출결 체크 및 정정 요청 관리</p>
                    </div>
                </div>
            </section>

            <!-- Agent Settings Modal -->
            <div id="agentSettingsModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2><i class="fas fa-cog"></i> <span id="modalAgentName"></span> 설정</h2>
                        <button class="modal-close" onclick="closeAgentSettings()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body" id="modalBody">
                        <!-- JavaScript로 동적 생성 -->
                    </div>
                    <div class="modal-footer">
                        <button class="modal-btn cancel-btn" onclick="closeAgentSettings()">
                            <i class="fas fa-times"></i> 취소
                        </button>
                        <button class="modal-btn save-btn" onclick="saveAgentSettings()">
                            <i class="fas fa-save"></i> 저장
                        </button>
                    </div>
                </div>
            </div>

            <!-- Student List -->
            <section class="student-list-section">
                <div class="section-header-with-actions">
                    <h2><i class="fas fa-list"></i> <span data-i18n="student.title">수강생 실시간 현황</span></h2>
                    <button id="exportExcel" class="export-btn">
                        <i class="fas fa-file-excel"></i>
                        <span data-i18n="student.export">출결현황 다운로드</span>
                    </button>
                </div>
                <div class="student-table-wrapper">
                    <table class="student-table">
                        <thead>
                            <tr>
                                <th data-i18n="student.number">번호</th>
                                <th data-i18n="student.name">이름</th>
                                <th data-i18n="student.phone">연락처</th>
                                <th data-i18n="student.isIn">참가여부</th>
                                <th data-i18n="student.status">상태</th>
                                <th data-i18n="student.camera">카메라</th>
                                <th data-i18n="student.lastSeen">마지막 확인</th>
                                <th data-i18n="student.warnings">경고</th>
                                <th data-i18n="student.actions">작업</th>
                            </tr>
                        </thead>
                        <tbody id="studentTableBody">
                            <!-- JavaScript로 동적 생성 -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Activity Log -->
            <section class="activity-log-section">
                <h2><i class="fas fa-history"></i> <span data-i18n="log.title">활동 로그</span></h2>
                <div class="log-container" id="activityLog">
                    <!-- JavaScript로 동적 생성 -->
                </div>
            </section>

            <!-- Teams Scheduled Meetings -->
            <section class="meeting-scheduler-section">
                <div class="section-header-with-actions">
                    <h2><i class="fas fa-calendar-check"></i> <span data-i18n="meeting.title">예약된 수업 일정</span></h2>
                    <button id="refreshMeetings" class="export-btn">
                        <i class="fas fa-sync-alt"></i>
                        <span data-i18n="meeting.refresh">새로고침</span>
                    </button>
                </div>

                <div class="meetings-info-box">
                    <i class="fas fa-info-circle"></i>
                    <p data-i18n="meeting.info">Teams에서 Power Automate로 예약된 수업 일정이 Microsoft Teams SDK를 통해 자동으로 불러와집니다.
                    </p>
                </div>

                <div class="meetings-log-container" id="meetingsLogContainer">
                    <!-- JavaScript로 동적 생성 -->
                </div>
            </section>

            <!-- Monthly Attendance -->
            <section class="monthly-attendance-section">
                <div class="section-header-with-actions">
                    <h2><i class="fas fa-calendar-alt"></i> <span data-i18n="attendance.title">월별 출석부</span></h2>
                    <div class="attendance-controls">
                        <select id="attendanceMonth" class="month-selector">
                            <!-- JavaScript로 동적 생성 -->
                        </select>
                        <button id="exportMonthlyAttendance" class="export-btn">
                            <i class="fas fa-file-excel"></i>
                            <span data-i18n="attendance.export">월별 출석부 다운로드</span>
                        </button>
                    </div>
                </div>

                <div class="monthly-stats-grid">
                    <div class="monthly-stat-card">
                        <div class="stat-icon-small present">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div>
                            <h4 data-i18n="attendance.avgRate">평균 출석률</h4>
                            <p class="stat-value-small" id="avgAttendanceRate">0%</p>
                        </div>
                    </div>
                    <div class="monthly-stat-card">
                        <div class="stat-icon-small time">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div>
                            <h4 data-i18n="attendance.avgTime">평균 출석시간률</h4>
                            <p class="stat-value-small" id="avgTimeRate">0%</p>
                        </div>
                    </div>
                    <div class="monthly-stat-card">
                        <div class="stat-icon-small total">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div>
                            <h4 data-i18n="attendance.totalDays">총 수업일수</h4>
                            <p class="stat-value-small" id="totalClassDays">0일</p>
                        </div>
                    </div>
                </div>

                <div class="attendance-table-wrapper">
                    <!-- Title for printing/viewing -->
                    <h3 id="attendanceMonthHeader" style="display:none; text-align:center; margin-bottom:10px;">2024년 5월
                        출석 현황</h3>
                    <table class="attendance-table" id="monthlyAttendanceTable">
                        <thead>
                            <tr>
                                <!-- Header content generated by JS -->
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <!-- JavaScript로 동적 생성 -->
                        </tbody>
                    </table>
                </div>
        </main>

        <!-- Footer -->
        <footer class="dashboard-footer">
            <p>&copy; 2025 강한 매니저. AI 기반 교육 관리 시스템</p>
            <p>Version 1.0.0 | <i class="fas fa-server"></i> Azure Cloud</p>
        </footer>
    </div>

    <!-- SheetJS 라이브러리 추가 (엑셀 생성용) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="js/i18n.js"></script>

    <!-- Data -->
    <script src="js/data/student_info.js"></script>

    <!-- Core -->
    <script src="js/store.js"></script>
    <script src="js/api.js"></script>

    <!-- Modules (Global Namespace) -->
    <script src="js/modules/logging.js"></script>
    <script src="js/modules/ui.js"></script>
    <script src="js/modules/agents.js"></script>
    <script src="js/modules/students.js"></script>
    <script src="js/modules/controls.js"></script>
    <script src="js/modules/meetings.js"></script>
    <script src="js/modules/attendance.js"></script>

    <!-- Main Orchestrator -->
    <script src="js/main.js"></script>
</body>

</html>